<!DOCTYPE html>
<html>
<body>

<h2>BIG INTEGERS MODULAR EXPONENTIATION</h2>

<button type="button" onclick="generate_random_number()">Generate random number</button>
<br/>
<br/>
BigInt Decimal: 
<div id="output"></div>
<br/>
g: <input id="g" name="g" value="174068207532402095185811980123523436538604490794561350978495831040599953488455823147851597408940950725307797094915759492368300574252438761037084473467180148876118103083043754985190983472601550494691329488083395492313850000361646482644608492304078721818959999056496097769368017749273708962006689187956744210730"><br/><br/>

a: <input id="a" name="a" value=""><br/><br/>
b: <input id="b" name="b" value=""><br/><br/>

p: <input id="p" name="p" value="178011905478542266528237562450159990145232156369120674273274450314442865788737020770612695252123463079567156784778466449970650770920727857050009668388144034129745221171818506047231150039301079959358067395348717066319802262019714966524135060945913707594956514672855690606794135837542707371727429551343320695239"><br/><br/>

<button type="button" onclick="modular_a()">Computes g^a mod p:</button><br/><br/>
A = <div name="ciphertext">
     <textarea class = "form-control" id ="ciphertext" rows = "3" cols = "50"></textarea>
    </div><br/><br/>

<button type="button" onclick="modular_b()">Computes g^b mod p:</button><br/><br/>
B = <div  name="ciphertext1">
    <textarea class = "form-control" id="ciphertext1" rows = "3" cols = "50"></textarea>
</div><br/><br/>

<button type="button" onclick="modular_g()">Computes g^ab mod p:</button><br/><br/>
A: <input id = "A" name = "A" value = ""><br/><br/>
Secret Key = <div id="ciphertext2" name="ciphertext2"></div><br/><br/>

<script src="biginteger.js"></script>

<script type="text/javascript">

	function generate_random_number(){
		// display output on the page
        document.getElementById('output').innerHTML = random_bigInt();
	}

    // generate random number
    // 
    //     one output: 160 bits random number (bigInt decimal) 
    //
    //     generate random number less than 2: 0 or 1
    //             Math.floor(Math.random() * 2)
    //
    function random_bigInt(){	

        var random_number = "";
        // generate random bit 160 times
    	for (i = 0; i < 160; i++) {
            random_number += Math.floor(Math.random() * 2);
        }
    	// return Decimal bigInt
        return bigInt(random_number,2);
    }
    function modular_a(){
        var g =document.getElementById("g").value;
        g = bigInt(g);// convert string to big integer

        var a =document.getElementById("a").value;
        a = bigInt(a);// convert string to big integer

        var p =document.getElementById("p").value;
        p = bigInt(p);// convert string to big integer

		// compute m^e mod n (big integer computation)
		var ciphertext = g.modPow(a, p);

        document.getElementById('ciphertext').innerHTML = ciphertext;
    }
    function modular_b(){
        var g =document.getElementById("g").value;
        g = bigInt(g);// convert string to big integer

        var b =document.getElementById("b").value;
        b = bigInt(b);// convert string to big integer

        var p =document.getElementById("p").value;
        p = bigInt(p);// convert string to big integer

		// compute m^e mod n (big integer computation)
		var ciphertext1 = g.modPow(b, p);

        document.getElementById('ciphertext1').innerHTML = ciphertext1;

    }
    function modular_g(){
        var b =document.getElementById("b").value;
        b = bigInt(b);// convert string to big integer

        var p =document.getElementById("p").value;
        p = bigInt(p);// convert string to big integer
        
        var A = document.getElementById("A").value;
        A = bigInt(A);

        var ciphertext2 = A.modPow(b, p);
        document.getElementById('ciphertext2').innerHTML = ciphertext2;
    }
</script>

</body>
</html>
